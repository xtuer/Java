<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>套卷管理</title>
    <link rel="stylesheet" href="/lib/semantic/semantic.min.css">
    <link rel="stylesheet" href="/css/adminPapers.css">
</head>

<body>
    <!-- [1] 菜单栏 -->
    <div class="ui left vertical inverted visible sidebar labeled icon menu">
        <a class="item"><i class="home icon"></i>Home</a>
        <a class="item" href="/adminPapers"><i class="share alternate square icon"></i> 套卷管理</a>
        <a class="item" href="/adminKnowledgePoints"><i class="block layout icon"></i> 知识点管理</a>
    </div>

    <!-- [2] 目录树 -->
    <div class="directory-tree-side-bar">
        <ul id="directory-tree" class="ztree"></ul>
    </div>

    <!-- 目录树的右键菜单 -->
    <ul id="directory-tree-menu">
        <li id="menu-item-create">新建文件夹</li>
        <li id="menu-item-delete">删除文件夹</li>
        <li id="menu-item-rename">重命名</li>
        <hr>
        <li id="menu-item-expand-all">全部展开</li>
        <li id="menu-item-refresh-count">刷新数量</li>
    </ul>

    <!-- [3] 网页的主要部分 -->
    <div class="main ui">
        <!-- 工具栏 -->
        <div class="ui grid" id="tool-bar">
            <div class="ui column">
                <button class="ui right floated circular basic button">导出</button>
                <div class="toggle-buttons">
                    <div class="ui labeled icon button" id="popup-choose-papers-dialog-button"><i class="icon plus"></i>添加试卷</div>
                    <div class="ui labeled icon button" id="show-konwledge-points"><i class="icon tags"></i>所有知识点</div>
                </div>
            </div>
        </div>

        <div class="ui one column grid" id="vue-knowledge-points" style="margin: -1rem 1rem; margin-top: 1rem;">
            <div class="ui column">
                <div class="ui segment">
                    <a class="ui tag label" :class="{checked: point.checked}" v-for="point in knowledgePoints" @click="showPapers(point, $event)" :key="point.knowledgePointId" v-text="point.name"></a>
                    <span v-show="knowledgePoints.length==0">没有知识点</span>
                </div>
            </div>
        </div>

        <!-- 试卷列表，使用 card 显示试卷 -->
        <!-- <div class="ui five column grid" id="vue-papers">
            <div class="ui column" v-for="(paper, index) in papers" :data-id="paper.paperId" :key="paper.paperId">
                <div class="ui card">
                    <div class="dimmable image">
                        <div class="ui dimmer">
                            <div class="content">
                                <div class="center">
                                    {{paper.originalName}}
                                    <hr>
                                    {{knowledgePointsString(paper.knowledgePoints)}}
                                </div>
                            </div>
                        </div>
                        <img src="/img/default.jpg">
                    </div>
                    <div class="content">
                        <div class="description elide" v-text="paper.name"></div>
                    </div>
                    <div class="extra content">
                        <i class="icon move" :data-id="paper.paperId" :data-paper-directory-id="paper.paperDirectoryId" :data-index="index" :data-name="paper.name"></i>
                        <i class="icon edit" @click="editPaper(index)"></i>
                        <i class="icon tags" :data-content="knowledgePointsString(paper.knowledgePoints)"></i>
                        <span class="elide" style="float: right;" v-html="paper.subject"></span>
                    </div>
                </div>
            </div>

            <div v-show="papers.length===0">当前目录没有试卷或则还没有选择目录</div>
        </div> -->
        <div class="" id="vue-papers">
            <table class="ui compact selectable celled table">
                <thead>
                <tr>
                    <th>试卷名称</th>
                    <th>试卷年份</th>
                    <th>所属地区</th>
                    <th>试卷来源</th>
                    <th>试卷类型</th>
                    <th>学科</th>
                    <th>状态</th>
                </tr>
                </thead>
                <tbody>
                    <tr v-for="(paper, index) in papers" :data-id="paper.paperId" :key="paper.paperId">
                        <td class="dnd-paper-name elide" v-text="paper.name" @click="editPaper(paper)" style="cursor: pointer; max-width: 500px;" :data-id="paper.paperId" :data-paper-directory-id="paper.paperDirectoryId" :data-index="index" :data-name="paper.name"></td>
                        <td v-text="paper.publishYear"></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td class="collapsing" v-text="paper.subject"></td>
                        <td class="collapsing">未处理</td>
                        <!-- <td class="collapsing">
                            <i class="icon move" :data-id="paper.paperId" :data-paper-directory-id="paper.paperDirectoryId" :data-index="index" :data-name="paper.name"></i>
                            <i class="icon write square" @click="editPaper(index)"></i>
                            <i class="icon drupal" @click="previewPaper(paper)"></i>
                            <i class="icon tags" :data-content="knowledgePointsString(paper.knowledgePoints)"></i>
                            <i class="icon cloud download" @click="downloadPaper(paper)"></i>
                        </td> -->
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Dialogs -->
    <!-- 试卷选择对话框 -->
    <div id="choose-papers-dialog">
        <div class="ui one column grid" id="vue-choose-papers">
            <div class="ui column">
                <!-- 选择学科 -->
                <div class="ui left action input" style="width: 100%;">
                    <select class="ui compact selection dropdown" v-model="subject">
                        <option value="高中语文">高中语文</option>
                        <option value="高中数学">高中数学</option>
                        <option value="高中物理">高中物理</option>
                        <option value="高中化学">高中化学</option>
                        <option value="高中历史">高中历史</option>
                        <option value="高中地理">高中地理</option>
                        <option value="高中生物">高中生物</option>
                    </select>
                    <input type="text" placeholder="搜索……" v-model.trim="nameFilter" @keyup.enter="findPapers()" style="border-radius: 0;">
                    <div type="submit" class="ui button" @click="findPapers()" style="border-radius: 0 .28571429rem .28571429rem 0;">搜索</div>
                </div>
            </div>

            <div class="ui column">
                <!-- 搜索得到的试卷 -->
                <div class="ui segment" :class="segmentClass(index)" v-for="(paper, index) in papers">
                    <div class="ui checkbox">
                        <input type="checkbox" v-model="paper.checked">
                        <label v-html="paper.name"></label>
                    </div>
                </div>
                <div v-show="papers.length==0">没有符合条件的试卷...</div>
            </div>
        </div>
    </div>

    <!-- 试卷编辑对话框 -->
    <div id="paper-editor-dialog">
        <div id="vue-paper-editor" class="ui form">
            <!-- <div class="field">
                <div class="ui labeled input">
                    <div class="ui label">原始名字</div>
                    <input type="text" v-model="paper.originalName" readonly="" style="color: #BBB;">
                </div>
            </div> -->
            <div class="field">
                <div class="ui labeled input">
                    <div class="ui label">显示名字</div>
                    <input type="text" v-model="paper.name">
                </div>
            </div>
            <div class="two fields">
                <!-- <div class="ui labeled input">
                    <div class="ui label">发布时间</div>
                    <input type="text" class="publish-year" id="publish-year" v-model="paper.publishYear" readonly="">
                </div> -->
                <div class="field">
                    <div class="ui calendar" id="year-chooser">
                        <div class="ui labeled input icon">
                            <div class="ui label">发布时间</div>
                            <i class="calendar icon"></i>
                            <input type="text" id="publish-year" v-model="paper.publishYear" placeholder="年" readonly="">
                        </div>
                    </div>
                </div>
                <div class="field" style="display: flex; align-items:center;">
                    <div class="ui checkbox">
                        <input type="checkbox" v-model="paper.exportable">
                        <label>可导出</label>
                    </div>
                </div>
            </div>
            <div class="field">
                <div class="ui two top attached buttons">
                    <!-- 知识点分类选择下拉框 -->
                    <div class="ui floating dropdown button knowledge-point-groups-dropdown">
                        <i class="icon object group"></i>
                        <span class="text">选择知识点分类</span>
                        <div class="menu">
                            <div class="item" v-for="group in knowledgePointGroups"
                                :key="group.knowledgePointGroupId"
                                :data-id="group.knowledgePointGroupId"
                                @click="loadKnowledgePoints(group)"
                                v-text="group.name">
                            </div>
                        </div>
                    </div>
                    <!-- 知识点选择下拉框 -->
                    <div class="ui floating dropdown button knowledge-points-dropdown" style="border-left: 1px solid #CCC;">
                        <i class="icon tag"></i>
                        <span class="text">选择知识点</span>
                        <div class="menu">
                            <div class="item" v-for="(point, index) in knowledgePoints"
                                :key="index"
                                @click="addKnowledgePointToPaper(point)"
                                v-text="point.name">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="ui bottom attached segment" style="height: 250px; overflow: auto;">
                    <a class="ui label" v-for="point in paper.knowledgePoints" style="margin-bottom: 5px;">
                        {{point.name}}
                        <i class="delete icon" @click="removeKnowledgePointFromPaper(point)"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="/lib/require.js"></script>
    <script src="/js/requireConfig.js"></script>
    <script src="/js/adminPapers.js"></script>
</body>

</html>
